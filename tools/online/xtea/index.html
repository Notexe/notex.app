<!DOCTYPE html><html lang="en"><head><meta name="theme-color" content="#a6d4fa"/><title>XTEA Online Tool - Notex.app</title><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="description" content="An online tool built to encode and decode files that use IOI&#x27;s modified XTEA algorithm."/><meta name="keywords" content="glacier engine, hitman, tools, resources, modding, mod, rpkg, locr, rtlv, dlge, gfxf, unpack, pack, discord, 007, ioi, io interactive"/><meta name="twitter:creator" content="@Notex_"/><meta name="twitter:title" content="XTEA Online Tool - Notex.app"/><meta name="twitter:description" content="An online tool built to encode and decode files that use IOI&#x27;s modified XTEA algorithm."/><meta name="twitter:dnt" content="on"/><meta name="twitter:url" content="https://notex.app/tools/online/xtea"/><link rel="author" href="https://twitter.com/Notex_"/><link rel="publisher" href="https://rdil.rocks"/><link rel="canonical" href="https://notex.app//tools/online/xtea"/><meta itemProp="name" content="XTEA Online Tool - Notex.app"/><meta name="next-head-count" content="14"/><link rel="preload" href="/_next/static/css/6444dcdec753727da7bd.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6444dcdec753727da7bd.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script defer="" src="/_next/static/chunks/735.9029fd3f5bc81e330325.js"></script><script src="/_next/static/chunks/webpack-2b9c1350ec0da5c68705.js" defer=""></script><script src="/_next/static/chunks/framework-c93ed74a065331c4bd75.js" defer=""></script><script src="/_next/static/chunks/main-23471793ada4561bbf96.js" defer=""></script><script src="/_next/static/chunks/pages/_app-e127ce3266b6d4899895.js" defer=""></script><script src="/_next/static/chunks/pages/tools/online/xtea-f86f6d815ce85413c2a2.js" defer=""></script><script src="/_next/static/YbKnp_V2VAIqrERKVwCYl/_buildManifest.js" defer=""></script><script src="/_next/static/YbKnp_V2VAIqrERKVwCYl/_ssgManifest.js" defer=""></script><style data-emotion="css-global 1bc9nrm">html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;box-sizing:border-box;-webkit-text-size-adjust:100%}*,::after,::before{box-sizing:inherit}b,strong{font-weight:700}body{margin:0;color:#fff;font-family:Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:400;font-size:1rem;line-height:1.5;background-color:#232425}@media print{body{background-color:#fff}}body::backdrop{background-color:#232425}</style><style data-emotion="css "></style></head><body><div id="__next"><div><div class="container"><header class="header"><span class="header-inner"><div id="xtealogo"><img class="xtealogo" src="/xtea.png" alt="XTEA logo."/></div><span class="header-right"><nav class="menu"><ul class="menu-inner"><li><a href="/rpkg/">RPKG Tool</a></li><li><a href="/tools/online/xtea">XTEA Online Tool</a></li><li><a href="/tools/offline/h6xtea.7z">XTEA Offline Tool</a></li><li><a href="https://hitmandb.notex.app">HitmanDB</a></li></ul></nav><a href="https://discord.gg/6UDtuYhZP6"><span class="discord-icon"><svg class="discord-icon" width="100" height="34" viewBox="0 0 800 272.1" xmlns="http://www.w3.org/2000/svg"><path class="st0" d="M142.8 120.1c-5.7 0-10.2 4.9-10.2 11s4.6 11 10.2 11c5.7 0 10.2-4.9 10.2-11s-4.6-11-10.2-11zM106.3 120.1c-5.7 0-10.2 4.9-10.2 11s4.6 11 10.2 11c5.7 0 10.2-4.9 10.2-11 .1-6.1-4.5-11-10.2-11z"></path><path class="st0" d="M191.4 36.9h-134c-11.3 0-20.5 9.2-20.5 20.5v134c0 11.3 9.2 20.5 20.5 20.5h113.4l-5.3-18.3 12.8 11.8 12.1 11.1 21.6 18.7V57.4c-.1-11.3-9.3-20.5-20.6-20.5zm-38.6 129.5s-3.6-4.3-6.6-8c13.1-3.7 18.1-11.8 18.1-11.8-4.1 2.7-8 4.6-11.5 5.9-5 2.1-9.8 3.4-14.5 4.3-9.6 1.8-18.4 1.3-25.9-.1-5.7-1.1-10.6-2.6-14.7-4.3-2.3-.9-4.8-2-7.3-3.4-.3-.2-.6-.3-.9-.5-.2-.1-.3-.2-.4-.2-1.8-1-2.8-1.7-2.8-1.7s4.8 7.9 17.5 11.7c-3 3.8-6.7 8.2-6.7 8.2-22.1-.7-30.5-15.1-30.5-15.1 0-31.9 14.4-57.8 14.4-57.8 14.4-10.7 28-10.4 28-10.4l1 1.2c-18 5.1-26.2 13-26.2 13s2.2-1.2 5.9-2.8c10.7-4.7 19.2-5.9 22.7-6.3.6-.1 1.1-.2 1.7-.2 6.1-.8 13-1 20.2-.2 9.5 1.1 19.7 3.9 30.1 9.5 0 0-7.9-7.5-24.9-12.6l1.4-1.6s13.7-.3 28 10.4c0 0 14.4 25.9 14.4 57.8 0-.1-8.4 14.3-30.5 15zM303.8 79.7h-33.2V117l22.1 19.9v-36.2h11.8c7.5 0 11.2 3.6 11.2 9.4v27.7c0 5.8-3.5 9.7-11.2 9.7h-34v21.1h33.2c17.8.1 34.5-8.8 34.5-29.2v-29.8c.1-20.8-16.6-29.9-34.4-29.9zm174 59.7v-30.6c0-11 19.8-13.5 25.8-2.5l18.3-7.4c-7.2-15.8-20.3-20.4-31.2-20.4-17.8 0-35.4 10.3-35.4 30.3v30.6c0 20.2 17.6 30.3 35 30.3 11.2 0 24.6-5.5 32-19.9l-19.6-9c-4.8 12.3-24.9 9.3-24.9-1.4zM417.3 113c-6.9-1.5-11.5-4-11.8-8.3.4-10.3 16.3-10.7 25.6-.8l14.7-11.3c-9.2-11.2-19.6-14.2-30.3-14.2-16.3 0-32.1 9.2-32.1 26.6 0 16.9 13 26 27.3 28.2 7.3 1 15.4 3.9 15.2 8.9-.6 9.5-20.2 9-29.1-1.8l-14.2 13.3c8.3 10.7 19.6 16.1 30.2 16.1 16.3 0 34.4-9.4 35.1-26.6 1-21.7-14.8-27.2-30.6-30.1zm-67 55.5h22.4V79.7h-22.4v88.8zM728 79.7h-33.2V117l22.1 19.9v-36.2h11.8c7.5 0 11.2 3.6 11.2 9.4v27.7c0 5.8-3.5 9.7-11.2 9.7h-34v21.1H728c17.8.1 34.5-8.8 34.5-29.2v-29.8c0-20.8-16.7-29.9-34.5-29.9zm-162.9-1.2c-18.4 0-36.7 10-36.7 30.5v30.3c0 20.3 18.4 30.5 36.9 30.5 18.4 0 36.7-10.2 36.7-30.5V109c0-20.4-18.5-30.5-36.9-30.5zm14.4 60.8c0 6.4-7.2 9.7-14.3 9.7-7.2 0-14.4-3.1-14.4-9.7V109c0-6.5 7-10 14-10 7.3 0 14.7 3.1 14.7 10v30.3zM682.4 109c-.5-20.8-14.7-29.2-33-29.2h-35.5v88.8h22.7v-28.2h4l20.6 28.2h28L665 138.1c10.7-3.4 17.4-12.7 17.4-29.1zm-32.6 12h-13.2v-20.3h13.2c14.1 0 14.1 20.3 0 20.3z"></path></svg></span></a></span></span></header><p id="failed-load-notif">You may need to reload the page unless you see the big box below. Sorry about that.</p><a href="/xtea/prepatched" class="description" style="color:white;cursor:pointer">Looking for a version of <code>packagedefinition.txt</code> <!-- -->that is already patched? Click here!</a><main class="main"><main id="main">
    <div id="save">
        <span onclick="saveFile();"> Save File </span>
        <span onclick="autopatch();"> Set Patch Levels </span>
    </div>
    <div id="naming">
        <input type="text" id="naming-field" />
    </div>
    <div class="wrapper">
        <textarea
            id="packagedefinitions"
            ondrop="dropHandler(event);"
            ondragover="dragOverHandler(event);"
        >
        </textarea>
    </div>
    <script>
        ;(function () {
            document.getElementById("failed-load-notif").hidden = true
            const __exports = {}
            let wasm

            let cachegetUint8Memory = null
            function getUint8Memory() {
                if (
                    cachegetUint8Memory === null ||
                    cachegetUint8Memory.buffer !== wasm.memory.buffer
                ) {
                    cachegetUint8Memory = new Uint8Array(wasm.memory.buffer)
                }
                return cachegetUint8Memory
            }

            let WASM_VECTOR_LEN = 0

            function passArray8ToWasm(arg) {
                const ptr = wasm.__wbindgen_malloc(arg.length * 1)
                getUint8Memory().set(arg, ptr / 1)
                WASM_VECTOR_LEN = arg.length
                return ptr
            }

            let cachegetUint32Memory = null
            function getUint32Memory() {
                if (
                    cachegetUint32Memory === null ||
                    cachegetUint32Memory.buffer !== wasm.memory.buffer
                ) {
                    cachegetUint32Memory = new Uint32Array(wasm.memory.buffer)
                }
                return cachegetUint32Memory
            }

            function passArray32ToWasm(arg) {
                const ptr = wasm.__wbindgen_malloc(arg.length * 4)
                getUint32Memory().set(arg, ptr / 4)
                WASM_VECTOR_LEN = arg.length
                return ptr
            }

            function getArrayU8FromWasm(ptr, len) {
                return getUint8Memory().subarray(ptr / 1, ptr / 1 + len)
            }

            let cachedGlobalArgumentPtr = null
            function globalArgumentPtr() {
                if (cachedGlobalArgumentPtr === null) {
                    cachedGlobalArgumentPtr = wasm.__wbindgen_global_argument_ptr()
                }
                return cachedGlobalArgumentPtr
            }

            __exports.encipher = function (data, delta, header, rounds, key) {
                const ptr0 = passArray8ToWasm(data)
                const len0 = WASM_VECTOR_LEN
                const ptr2 = passArray8ToWasm(header)
                const len2 = WASM_VECTOR_LEN
                const ptr4 = passArray32ToWasm(key)
                const len4 = WASM_VECTOR_LEN
                const retptr = globalArgumentPtr()
                wasm.encipher(
                    retptr,
                    ptr0,
                    len0,
                    delta,
                    ptr2,
                    len2,
                    rounds,
                    ptr4,
                    len4
                )
                const mem = getUint32Memory()
                const rustptr = mem[retptr / 4]
                const rustlen = mem[retptr / 4 + 1]
                if (rustptr === 0) return
                const realRet = getArrayU8FromWasm(rustptr, rustlen).slice()
                wasm.__wbindgen_free(rustptr, rustlen * 1)
                return realRet
            }

            __exports.decipher = function (data, delta, header, rounds, key) {
                const ptr0 = passArray8ToWasm(data)
                const len0 = WASM_VECTOR_LEN
                const ptr2 = passArray8ToWasm(header)
                const len2 = WASM_VECTOR_LEN
                const ptr4 = passArray32ToWasm(key)
                const len4 = WASM_VECTOR_LEN
                const retptr = globalArgumentPtr()
                wasm.decipher(
                    retptr,
                    ptr0,
                    len0,
                    delta,
                    ptr2,
                    len2,
                    rounds,
                    ptr4,
                    len4
                )
                const mem = getUint32Memory()
                const rustptr = mem[retptr / 4]
                const rustlen = mem[retptr / 4 + 1]
                if (rustptr === 0) return
                const realRet = getArrayU8FromWasm(rustptr, rustlen).slice()
                wasm.__wbindgen_free(rustptr, rustlen * 1)
                return realRet
            }

            function init(module) {
                let result
                const imports = { "./hitwasm_xtea": __exports }

                if (
                    module instanceof URL ||
                    typeof module === "string" ||
                    module instanceof Request
                ) {
                    const response = fetch(module)
                    if (
                        typeof WebAssembly.instantiateStreaming === "function"
                    ) {
                        result = WebAssembly.instantiateStreaming(
                            response,
                            imports
                        ).catch((e) => {
                            console.warn(
                                "`WebAssembly.instantiateStreaming` failed. Assuming this is because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",
                                e
                            )
                            return response
                                .then((r) => r.arrayBuffer())
                                .then((bytes) =>
                                    WebAssembly.instantiate(bytes, imports)
                                )
                        })
                    } else {
                        result = response
                            .then((r) => r.arrayBuffer())
                            .then((bytes) =>
                                WebAssembly.instantiate(bytes, imports)
                            )
                    }
                } else {
                    result = WebAssembly.instantiate(module, imports).then(
                        (result) => {
                            if (result instanceof WebAssembly.Instance) {
                                return { instance: result, module }
                            } else {
                                return result
                            }
                        }
                    )
                }
                return result.then(({ instance, module }) => {
                    wasm = instance.exports
                    init.__wbindgen_wasm_module = module

                    return wasm
                })
            }

            self.wasm_bindgen = Object.assign(init, __exports)
        })()

        function autopatch() {
            let target = document.getElementById("packagedefinitions")
            target.value = target.value.replace(
                /patchlevel=\d+\n/gi,
                "patchlevel=10000\n"
            )
        }

        // Thumbs and PackageDefinitions Header
        const HEADER = [
            0x22,
            0x3d,
            0x6f,
            0x9a,
            0xb3,
            0xf8,
            0xfe,
            0xb6,
            0x61,
            0xd9,
            0xcc,
            0x1c,
            0x62,
            0xde,
            0x83,
            0x41,
        ]

        // Key
        const XTEA_KEY = new Uint32Array([
            0x30f95282,
            0x1f48c419,
            0x295f8548,
            0x2a78366d,
        ])

        // Delta
        const XTEA_DELTA = 0x61c88647

        // Rounds
        const XTEA_ROUNDS = 32

        function markFailure() {
            disable()
            alert("Invalid input")
        }

        function disable() {
            let target = document.getElementById("packagedefinitions")
            target.value =
                "Drag and drop packagedefinition.txt/thumbs.dat here."
            target.readOnly = true

            document.getElementById("save").style.visibility = "hidden"
        }

        function enable() {
            document.getElementById("packagedefinitions").readOnly = false
            document.getElementById("save").style.visibility = "visible"
        }

        function compileOutput() {
            let target = document.getElementById("packagedefinitions")
            let raw = new TextEncoder("utf-8").encode(target.value)
            return wasm_encipher(raw, XTEA_DELTA, HEADER, XTEA_ROUNDS, XTEA_KEY)
        }

        function saveFile() {
            // Build the internal data
            const saveData = (function () {
                const a = document.createElement("a")
                document.body.appendChild(a)
                a.style = "display: none"
                return function (data, fileName) {
                    const blob = new Blob([data], {
                            type: "application/octet-stream"
                        }),
                        url = window.URL.createObjectURL(blob)
                    a.href = url
                    a.download = fileName
                    a.click()
                    window.URL.revokeObjectURL(url)
                }
            })()

            let fileName = "compiled"

            try {
                fileName = document.getElementById("naming-field").value
            } catch (e) {
                /* alert(e); */
            }
            let data = compileOutput()

            saveData(data, fileName)
        }

        function decipher(buffer) {
            // Let the XTEA handler do the work.
            let new_buffer = wasm_decipher(
                buffer,
                XTEA_DELTA,
                HEADER,
                XTEA_ROUNDS,
                XTEA_KEY
            )
            enable()
            document.getElementById(
                "packagedefinitions"
            ).value = new TextDecoder("utf-8").decode(new_buffer)
        }

        function attemptDecipher(file) {
            const reader = new FileReader()
            reader.onload = (event) => {
                try {
                    let buffer = new Uint8Array(event.target.result)
                    decipher(buffer)
                } catch (e) {
                    console.log(e)
                    markFailure()
                }
            }
            reader.onerror = () => rej("error while reading")
            reader.readAsArrayBuffer(file)
        }

        function dropHandler(ev) {
            /* Block page change */
            ev.preventDefault()

            /* Decipher */
            if (ev.dataTransfer.items) {
                let fileCount = 0
                for (let i = 0; i < ev.dataTransfer.items.length; i++) {
                    if (ev.dataTransfer.items[i].kind === "file") {
                        fileCount += 1
                    }
                }

                if (fileCount > 1) {
                    alert("Only one file is allowed")
                    return
                }

                for (let i = 0; i < ev.dataTransfer.items.length; i++) {
                    if (ev.dataTransfer.items[i].kind === "file") {
                        let file = ev.dataTransfer.items[i].getAsFile()
                        document.getElementById("naming-field").value =
                            file.name
                        attemptDecipher(file)
                        break
                    }
                }
            } else {
                if (ev.dataTransfer.files.length > 1) {
                    alert("Only one file is allowed")
                    return
                }
                let file = ev.dataTransfer.items[i].getAsFile()
                document.getElementById("naming-field").value = file.name
                attemptDecipher(file)
            }
        }

        function dragOverHandler(ev) {
            /* Prevent the browser doing anything insane. */
            ev.preventDefault()
        }

        wasm_encipher = 0
        wasm_decipher = 0
        document.addEventListener("DOMContentLoaded", function () {
            disable()
        })
    </script>
    <script type="module">
        /* Pull WASM */
        const { encipher, decipher } = wasm_bindgen
        async function run() {
            await wasm_bindgen("/hitwasm_xtea.wasm")
            wasm_encipher = encipher
            wasm_decipher = decipher
        }
        run()
    </script>
</main></div></div></div></body>
</main></html>